---
title: "Data import and cleaning from .xlsx files sent by the Technion"
author: "Amir Levine"
date: "2018-10-29"
output: md_document
---

Load tidyverse.
```{r}
if (!require(tidyverse)) {install.packages("tidyverse"); library(tidyverse)}
```

Import the gene expression data sent by Efrat from the Technion.
Specifiy how to treat NA values.
Specify the columns' data-types, as by default in loads all as characters.
```{r}
AM <- readxl::read_excel(
  "raw/2018-10-25-Results_files/Final_results_AM140_treated_vs_untreated_.xlsx", 
  col_names = TRUE, 
  col_types = c(rep("text",4),rep("numeric",5),rep("text",4)), 
  na = 'NA')
CL <- readxl::read_excel(
  "raw/2018-10-25-Results_files/Final_results_CL2006_treated_vs_untreated_.xlsx",
  col_names = TRUE, 
  col_types = c(rep("text",4),rep("numeric",5),rep("text",4)), 
  na = 'NA')
N2 <- readxl::read_excel(
  "raw/2018-10-25-Results_files/Final_results_N2_treated_vs_untreated.xlsx",
  col_names = TRUE, 
  col_types = c(rep("text",4),rep("numeric",5),rep("text",4)), 
  na = 'NA')
```

Merge the three data-frames to one gene expression (ge) data-frame.
Remove unnecessary columnns.
Focus on genes that underwent the multiple comparisons test (*Tested*)
```{r}
ge <- bind_rows(list(N2 = N2,AM140 = AM, CL2006 = CL), .id = 'strain')

glimpse(ge) # Check the variables of the new data-frame

ge %<>% 
  dplyr::filter(`flag Treated vs untreated` == "Tested") %>%
  dplyr::select(strain,
                `Gene ID`,
                `gene name`,
                baseMean,
                `log2FoldChange Treated vs untreated`,
                `padj Treated vs untreated`) %>%
  arrange(`padj Treated vs untreated`)
```

